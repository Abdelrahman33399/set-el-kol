<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <link rel="icon" href="../../Image_fx6.jpg" type="image/x-icon">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>الاختبار - تاريخ التربية</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        :root {
            --bg-color: #121212;
            --card-bg: rgba(255, 255, 255, 0.05);
            --border-color: rgba(255, 255, 255, 0.1);
            --text-light: #e0e0e0;
            --primary-neon: linear-gradient(45deg, #a453ff, #54aaff);
            --accent-orange: #ff6b35;
        }
        .day-mode {
            --bg-color: #1b405f;
            --card-bg: rgba(255, 255, 255, 0.7);
            --text-light: #ec6211;
        }
        body {
            background-color: var(--bg-color);
            color: var(--text-light);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            transition: background-color 0.3s;
        }
        .quiz-container, .final-form, .result-container {
            display: none;
            background: var(--card-bg);
            padding: 2rem;
            border-radius: 20px;
            margin: 2rem auto;
            max-width: 800px;
            border: 1px solid var(--border-color);
        }
        .quiz-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }
        .question-counter {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--accent-orange);
        }
        .question-text {
            font-size: 1.3rem;
            margin-bottom: 2rem;
            color: var(--text-light);
            font-weight: 600;
        }
        .options-container {
            display: grid;
            gap: 1rem;
            margin-bottom: 2rem;
        }
        .option-btn {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #ddd;
            padding: 1rem;
            border-radius: 12px;
            text-align: right;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 1.1rem;
        }
        .option-btn:hover {
            background: rgba(255, 107, 53, 0.2);
            color: var(--text-light);
        }
        .option-btn.selected {
            background: var(--accent-orange);
            color: white;
            transform: scale(1.02);
        }
        .option-btn.correct {
            background: #28a745;
            color: white;
        }
        .option-btn.wrong {
            background: #dc3545;
            color: white;
        }
        .essay-input {
            width: 100%;
            min-height: 120px;
            padding: 1rem;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid var(--border-color);
            color: var(--text-light);
            font-size: 1.1rem;
            resize: vertical;
            margin-bottom: 1.5rem;
        }
        .quiz-btns {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 2rem;
            flex-wrap: wrap;
        }
        .quiz-btn {
            padding: 12px 30px;
            border-radius: 30px;
            font-weight: 600;
            transition: all 0.3s;
            white-space: nowrap;
        }
        .next-btn, .submit-btn {
            background: var(--accent-orange);
            color: white;
        }
        .next-btn:hover, .submit-btn:hover {
            background: #e05a2a;
        }
        .restart-btn {
            background: #6c757d;
            color: white;
        }
        .back-btn {
            background: #28a745;
            color: white;
        }
        .result-score {
            font-size: 3rem;
            font-weight: 800;
            background: var(--primary-neon);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 1rem 0;
        }
        .result-text {
            font-size: 1.3rem;
            margin-bottom: 2rem;
            color: var(--text-light);
        }
        .explanation {
            background: rgba(255, 255, 255, 0.05);
            padding: 1.5rem;
            border-radius: 12px;
            margin: 1.5rem 0;
            text-align: right;
            border-right: 4px solid var(--accent-orange);
        }
        .explanation h5 {
            color: var(--accent-orange);
            margin-bottom: 0.5rem;
        }
        .final-form input {
            width: 100%;
            padding: 12px;
            margin: 0.5rem 0;
            border-radius: 12px;
            background: rgba(255,255,255,0.1);
            border: 1px solid var(--border-color);
            color: var(--text-light);
            font-size: 1.1rem;
        }
        .theme-toggle-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            background: var(--accent-orange);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 1.2rem;
            cursor: pointer;
            z-index: 1000;
        }
        .back-to-home-btn {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: var(--accent-orange);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 30px;
            text-decoration: none;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <button id="themeToggle" class="theme-toggle-btn">
        <i class="fas fa-moon"></i>
    </button>

    <div class="container py-5">
        <div id="quizContainer" class="quiz-container">
            <div class="quiz-header">
                <div class="question-counter" id="questionCounter">السؤال 1 من 2</div>
                <button class="btn btn-outline-light" onclick="exitQuiz()">
                    <i class="fas fa-times"></i> إنهاء
                </button>
            </div>
            <div class="question-text" id="questionText">نص السؤال هنا...</div>
            <div class="options-container" id="optionsContainer"></div>
            <div class="quiz-btns">
                <button class="quiz-btn next-btn d-none" id="nextBtn" onclick="nextQuestion()">التالي</button>
                <button class="quiz-btn submit-btn d-none" id="submitEssayBtn" onclick="submitEssay()">تسليم</button>
            </div>
        </div>

        <div id="finalFormContainer" class="final-form">
            <h3 class="text-center mb-4">أدخل بياناتك</h3>
            <input type="text" id="studentName" placeholder="الاسم الكامل" required>
            <input type="text" id="studentId" placeholder=" (ID)" required>
            <div class="quiz-btns mt-3">
                <button class="quiz-btn next-btn" onclick="saveStudentData()">حفظ</button>
            </div>
        </div>

        <div id="resultContainer" class="result-container">
            <h2>🎉 انتهيت من الاختبار!</h2>
            <div class="result-score" id="finalScore">0/2</div>
            <div class="result-text" id="resultText">أحسنت! واصل التميز 🌟</div>
            <div id="explanationsContainer"></div>
            <div class="mt-4">
                <h4>شارك نتيجتك أو احفظها</h4>
                <div class="input-group mb-3">
                    <span class="input-group-text">+<input type="text" id="countryCode" placeholder="رمز الدولة" style="max-width:80px; text-align:center;" value="20"></span>
                    <input type="text" id="phoneNumber" class="form-control" placeholder="رقم الهاتف (بدون صفر)">
                </div>
                <div class="quiz-btns">
                    <button class="quiz-btn back-btn" onclick="shareToWhatsApp()">
                        <i class="fab fa-whatsapp"></i> إرسال عبر واتساب
                    </button>
                    <button class="quiz-btn next-btn" onclick="downloadPDF()">
                        <i class="fas fa-file-pdf"></i> تحميل كـ PDF
                    </button>
                    <button class="quiz-btn restart-btn" onclick="restartQuiz()">
                        <i class="fas fa-redo"></i> إعادة الاختبار
                    </button>
                    <button class="quiz-btn back-btn" onclick="backToMaterials()">
                        <i class="fas fa-list"></i> العودة للمواد
                    </button>
                </div>
            </div>
        </div>

        <a href="materials.html" class="back-to-home-btn">
            <i class="fas fa-arrow-left me-2"></i> العودة للمواد
        </a>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDeapYypO595vcDWUoh1gOncsGkQ5EZdyE",
            authDomain: "sit-el-kol.firebaseapp.com",
            projectId: "sit-el-kol",
            storageBucket: "sit-el-kol.firebasestorage.app",
            messagingSenderId: "573924344198",
            appId: "1:573924344198:web:fec2e9a54c1c152cd16c07"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        window.saveToFirebase = async function(data) {
            try {
                await addDoc(collection(db, "quiz_submissions"), data);
            } catch (e) {
                console.error("فشل حفظ البيانات:", e);
            }
        };
    </script>

    <script>
       const questions = [
    {
        type: "mcq",
        question: "ما الهدف الأساسي من دراسة \"الجذور والتطور\" في تاريخ التربية؟",
        options: [
            "حفظ أسماء المربين القدماء",
            "فهم كيف تشكلت الأفكار والممارسات التربوية عبر الزمن ووصلت إلى وضعها الراهن",
            "مقارنة المناهج القديمة بالحديثة فقط",
            "تمجيد الحضارات السابقة"
        ],
        correct: 1,
        explanation: "دراسة الجذور لا تهدف إلى الحنين للماضي، بل إلى تتبع التحوّلات التاريخية التي أنتجت واقعنا التربوي، مما يُمكّن من فهم طبيعة السياسات والأنظمة الحالية."
    },
    {
        type: "mcq",
        question: "كيف يفسّر تاريخ التربية \"الواقع التربوي الحاضر\"؟",
        options: [
            "بعرض صور للمدارس القديمة",
            "بإظهار أن الماضي منفصل تمامًا عن الحاضر",
            "بكشف أن السياسات الحالية هي امتداد لتجارب وفلسفات سابقة",
            "بتأييد جميع الممارسات المعاصرة"
        ],
        correct: 2,
        explanation: "الواقع التربوي ليس نتاج لحظة عابرة، بل هو امتداد تاريخي؛ فمثلاً، النظام المركزي في التعليم قد يعود إلى تجارب الدولة الحديثة في عهد محمد علي، وليس اختيارًا عشوائيًا."
    },
    {
        type: "mcq",
        question: "ما الدور الذي يلعبه تاريخ التربية في \"تنمية الفكر النقدي\" لدى الطالب المعلم؟",
        options: [
            "تعليمه حفظ الوقائع التاريخية",
            "تدريبه على تمييز الصحيح من السقيم في الروايات التربوية عبر \"حسن النظر وتثبيت الفكر\"",
            "تشجيعه على تقليد المربين القدماء",
            "تقليل اعتماده على التكنولوجيا"
        ],
        correct: 1,
        explanation: "كما أشار النص، فإن دراسة التاريخ تتطلب تحليلًا نقديًا للروايات، وليس تلقيها كحقائق مطلقة، مما يُنمّي مهارات التمييز والتحليل لدى المعلم المستقبلي."
    },
    {
        type: "mcq",
        question: "أي من العبارات التالية تُعبّر عن \"الأهمية الحضارية\" لدراسة تاريخ التربية؟",
        options: [
            "تساعد في تصميم شعارات المدارس",
            "تُحقّق التعارف بين الحضارات وتفهم آليات نقل التراث الثقافي",
            "تُقلل من الحاجة إلى تدريس التاريخ العام",
            "تُركّز على الحضارة الغربية فقط"
        ],
        correct: 1,
        explanation: "دراسة تاريخ التربية تُسهم في التعارف الحضاري (كما في الآية: \"لتعارفوا\")، وتكشف كيف نقلت المجتمعات تراثها عبر آليات تربوية، مما يحافظ على الهوية ويُثري الفهم المتبادل."
    },
    {
        type: "mcq",
        question: "لماذا يُعدّ تاريخ التربية \"مختبرًا طبيعيًا\"؟",
        options: [
            "لأنه يحتوي على معامل كيميائية قديمة",
            "لأنه يخزن تجارب تربوية متنوعة يمكن تحليل نتائجها دون مخاطرة",
            "لأنه يُدرّس في المختبرات التربوية",
            "لأنه يعتمد على التجارب المعملية"
        ],
        correct: 1,
        explanation: "الماضي يحتوي على آلاف التجارب (مثل تجربة أثينا في التعليم الديمقراطي، أو إسبرطة في التعليم العسكري)، ويمكن استخلاص الدروس منها دون تكرار أخطائها، مما يجعله \"مختبرًا\" آمنًا للتعلّم."
    },
    {
        type: "mcq",
        question: "ما العلاقة بين \"الأساليب التربوية في المجتمعات البدائية\" و\"الدافع الداخلي للتعلم\"؟",
        options: [
            "الدافع كان خارجيًا بسبب العقوبات",
            "الدافع كان داخليًا لأن التعلم مرتبط بالبقاء المباشر",
            "لم يكن هناك دافع حقيقي",
            "الدافع ناتج عن المنافسة بين القبائل"
        ],
        correct: 1,
        explanation: "في المجتمعات البدائية، كان الطفل يتعلم لأن حياته تعتمد على ذلك (مثل الصيد أو الزراعة)، لذا كان الدافع داخليًا وقويًا، على عكس كثير من الأنظمة الحديثة التي تعتمد على الحوافز الخارجية (كالدرجات)."
    },
    {
        type: "mcq",
        question: "أي من الخصائص التالية تميّز \"المعلم في المجتمعات البدائية\"؟",
        options: [
            "معلم متخصص معزول عن الممارسة",
            "شخص يمارس ما يعلّمه (كالأب الصياد)",
            "يعتمد على الكتب المدرسية",
            "يُدرّس في فصل مغلق"
        ],
        correct: 1,
        explanation: "المعلم كان جزءًا من عملية الإنتاج، يمارس المهارة التي يُعلّمها، مما يجعل التعليم موثوقًا ومرتبطًا بالواقع، وينمّي شعورًا بالمسؤولية لدى المتعلم."
    },
    {
        type: "mcq",
        question: "ما الدرس المستفاد من \"غياب المؤسسات الرسمية\" في التربية البدائية؟",
        options: [
            "أن المدارس غير ضرورية",
            "أن التعليم يجب أن يكون منفصلًا عن الحياة",
            "أن ربط التعليم بالحياة اليومية يعزز فعاليته",
            "أن التكنولوجيا تحل محل الأسرة"
        ],
        correct: 2,
        explanation: "غياب المدارس لم يمنع التعلم، بل جعله عضويًا ومباشرًا. هذا يُشير إلى ضرورة تقليص الفجوة بين المدرسة والحياة في الأنظمة الحديثة."
    },
    {
        type: "mcq",
        question: "كيف ساهمت الفلسفات الاجتماعية في تشكيل الأنظمة التربوية عبر التاريخ؟",
        options: [
            "لم يكن لها أي تأثير",
            "كانت الأنظمة التربوية مستقلة تمامًا عن الفلسفة",
            "كشف تاريخ التربية عن الصلة بين المثل العليا والسياسات التعليمية",
            "ركّزت الفلسفة فقط على الأخلاق"
        ],
        correct: 2,
        explanation: "النص يوضح أن تاريخ التربية يكشف عن القيم والمبادئ (المثل العليا) التي سعت المجتمعات لتحقيقها، مثل العدالة عند الإغريق أو التقوى عند المسلمين، مما يُظهر الترابط العضوي بين الفلسفة والتربية."
    },
    {
        type: "mcq",
        question: "ما دور \"الذاكرة الجماعية التحذيرية\" في وظيفة تاريخ التربية؟",
        options: [
            "نسيان الأخطاء السابقة",
            "تذكير المربين بأخطاء الماضي لتجنب تكرارها",
            "التركيز على الإنجازات فقط",
            "تعزيز النظرة السلبية للتاريخ"
        ],
        correct: 1,
        explanation: "التاريخ يعمل كـ حارس يقظ يذكّر المربين والقائمين على السياسات بأخطاء سابقة (مثل فرض مناهج لا تتناسب مع الثقافة)، مما يمنع التكرار الأعمى."
    },
    {
        type: "mcq",
        question: "لماذا يُعدّ فهم \"التجارب التربوية السابقة\" مهمًا لصناع القرار؟",
        options: [
            "لتقليدها حرفيًا",
            "لاتخاذ قرارات مستنيرة مبنية على فهم السياقات التاريخية، كما أشار ابن خلدون",
            "لتقليل ميزانية التعليم",
            "لتعزيز المركزية الإدارية"
        ],
        correct: 1,
        explanation: "المعرفة التاريخية تُزوّد صانع القرار بأدوات تحليلية لفهم طبيعة العمران والمجتمع، مما يسمح باتخاذ قرارات تربوية واعية وليست ارتجالية."
    },
    {
        type: "mcq",
        question: "ما الفرق الجوهري في \"العلاقة بين الأجيال\" بين المجتمعات البدائية والحديثة؟",
        options: [
            "لا فرق يُذكر",
            "في البدائية: فجوة كبيرة؛ في الحديثة: انسجام تام",
            "في البدائية: انسجام وتماثل؛ في الحديثة: فجوة بسبب التغير السريع",
            "في الحديثة: الآباء يتعلمون من الأبناء فقط"
        ],
        correct: 2,
        explanation: "في المجتمعات البدائية، يعيش الابن حياة أبيه، فلا فجوة. أما في المجتمعات الحديثة، فإن التسارع التكنولوجي والاجتماعي يولّد فجوة بين الأجيال، تُضعف نقل الخبرة."
    },
    {
        type: "mcq",
        question: "ما الذي يُحقّقه فهم \"مشكلات الحاضر\" عبر العدسة التاريخية؟",
        options: [
            "تبرير الفشل الحالي",
            "معالجة جذرية للمشكلات عبر فهم جذورها التكوينية",
            "إلغاء الحاجة إلى الإصلاح",
            "التركيز على الماضي فقط"
        ],
        correct: 1,
        explanation: "الدراسة التاريخية تسمح بالحفر وراء الجذور (مثل طغيان النظرية على التطبيق)، مما يُمكّن من معالجة الأسباب الحقيقية، لا الأعراض فقط."
    },
    {
        type: "mcq",
        question: "كيف يُسهم تاريخ التربية في \"تشكيل الهوية المهنية\" للمعلم؟",
        options: [
            "بتعليمه استخدام السبورة الذكية",
            "بمنحه رؤية أوسع لدوره التاريخي والاجتماعي",
            "بتقليل ساعات العمل",
            "بتركيزه على الجانب الإداري فقط"
        ],
        correct: 1,
        explanation: "المعرفة التاريخية تجعل المعلم يرى نفسه حلقة في سلسلة كفاح تربوي عبر العصور، مما يعزز وعيه برسالته ويزيد فاعليته."
    },
    {
        type: "mcq",
        question: "ما العلاقة بين \"التفكير الميتافيزيقي\" في التربية البدائية و\"التعليم الديني\"؟",
        options: [
            "لا علاقة بينهما",
            "كان التعليم يمتزج بالمعتقدات الدينية والسحرية، ويسود الاعتقاد بقوى خارقة",
            "كان الدين ممنوعًا في التعليم",
            "كان التفكير علميًا بحتًا"
        ],
        correct: 1,
        explanation: "في المجتمعات البدائية، لم يكن هناك فصل بين المعرفي والديني؛ فكانت الطقوس والمعتقدات جزءًا من عملية نقل المعرفة، خاصة في تفسير الظواهر الطبيعية."
    },
    {
        type: "essay",
        question: "اشرح كيف يُسهم فهم \"الفلسفات الاجتماعية السائدة\" عبر التاريخ في تحليل السياسات التعليمية المعاصرة.",
        modelAnswer: "السياسات التعليمية ليست محايدة، بل تعكس المثل العليا والقيم السائدة في مجتمع ما. فمثلاً، النظام التعليمي الذي يركّز على الطاعة والانضباط قد يعكس فلسفة اجتماعية محافظة، بينما النظام الذي يشجّع النقاش والتفكير النقدي يعكس فلسفة ليبرالية. دراسة تاريخ التربية تكشف هذه الروابط، مما يمكّن المربين من تحليل سياساتهم الحالية نقدًا، وفهم ما إذا كانت تخدم أهدافًا تحررية أم تسلطية، وبالتالي المساهمة في تطويرها."
    },
    {
        type: "essay",
        question: "لماذا يُعدّ \"الماضي مختبرًا طبيعيًا\" في سياق تطوير تكنولوجيا التعليم؟",
        modelAnswer: "الماضي يحتوي على تجارب غنية في دمج الأدوات المتاحة مع الأهداف التربوية (مثل استخدام الطقوس في المجتمعات البدائية كوسيلة لنقل القيم). في سياق تكنولوجيا التعليم، يمكن تحليل هذه التجارب لاستخلاص مبادئ عامة: مثل أهمية السياق، أو الدور التشاركي في التعلم. بدلًا من اختراع حلول من الصفر، يمكننا تكييف هذه المبادئ مع الأدوات الرقمية الحديثة، مما يضمن فعالية أكبر وتجنبًا للأخطاء التاريخية (مثل فصل التكنولوجيا عن احتياجات المتعلمين الحقيقية)."
    },
    {
        type: "essay",
        question: "كيف يُفسّر النص ظاهرة \"الفجوة بين الأجيال\" في المجتمعات الحديثة من منظور تاريخي؟",
        modelAnswer: "النص يشير إلى أن المجتمعات البدائية كانت تتميز بتماثل تام بين حياة الآباء والأبناء، مما سهّل نقل الخبرة. أما في المجتمعات الحديثة، فإن التسارع التكنولوجي والاجتماعي جعل تجربة الشباب مختلفة جذريًا عن تجربة آبائهم، فظهرت \"فجوة الأجيال\". هذه الفجوة تُضعف دور الأسرة كمؤسسة تعليمية، وتزيد الاعتماد على المدرسة، التي غالبًا ما تكون غير قادرة على سد هذه الفجوة، مما يستدعي إعادة تصميم العلاقة بين الأجيال عبر برامج تربوية تشاركية."
    },
    {
        type: "essay",
        question: "ما العلاقة بين \"الدافع الداخلي للتعلم\" في المجتمعات البدائية و\"أزمة الدافعية\" في المدارس الحديثة؟",
        modelAnswer: "في المجتمعات البدائية، كان التعلم ضروريًا للبقاء، لذا كان الدافع داخليًا وقويًا. أما في المدارس الحديثة، فقد انفصل التعليم عن الحياة اليومية، وأصبح هدفه الأساسي هو اجتياز الامتحانات، مما ولّد دافعًا خارجيًا هشًا. هذا يفسر أزمة الملل والفتور لدى الطلاب. الحل يكمن في إعادة ربط المحتوى التعليمي باحتياجات الحياة الواقعية، مستلهمًا الدروس من التربية البدائية، خاصة في تصميم بيئات تعلم تكنولوجية تحاكي سياقات حقيقية."
    },
    {
        type: "essay",
        question: "كيف يُسهم تاريخ التربية في \"بناء رؤية مستقبلية\" للمعلم في عصر التكنولوجيا؟",
        modelAnswer: "دراسة تاريخ التربية لا تنظر إلى الماضي كنهاية، بل كـ خامات غنية للبناء عليها. المعلم الذي يفهم كيف تطورت الأفكار التربوية (من سقراط إلى بياجي) يصبح قادرًا على صياغة فكر تربوي مبدع يدمج الحكمة التاريخية مع إمكانيات العصر الرقمي. بدلًا من أن يكون مستهلكًا للمحتوى التكنولوجي، يصبح مُنتِجًا لتجارب تعليمية جديدة تزرع \"أشجارًا\" في حقل التربية، تخدم الأجيال القادمة."
    },
    {
        type: "essay",
        question: "لماذا يُعدّ \"الحفاظ على التراث الإنساني\" وظيفة جوهرية لتاريخ التربية؟",
        modelAnswer: "التربية هي الآلية الأساسية لنقل التراث الثقافي من جيل إلى آخر. دراسة تاريخها تعني دراسة كيف نقلت المجتمعات معارفها، قيمها، وإنجازاتها عبر الزمن. في عصر العولمة، الذي يهدد الخصوصيات الثقافية، يصبح فهم هذه الآلية ضروريًا لحماية الهوية، وتمكين الأجيال من استيعاب تراثها دون انغلاق، أو فقدانه دون وعي. بالتالي، تاريخ التربية هو حارس للذاكرة الجماعية الإنسانية."
    },
    {
        type: "essay",
        question: "ما الدور الذي يلعبه \"النقد التاريخي\" في تكوين معلم تكنولوجيا تعليم فعّال؟",
        modelAnswer: "معلم تكنولوجيا التعليم لا يكتفي بتطبيق الأدوات، بل يجب أن ينتقد ويحلّل فعاليتها في سياقات متنوعة. النقد التاريخي يُدرّبه على تمييز ما هو جوهري في التجارب التربوية من ما هو طارئ أو سلبي. فمثلاً، عند استخدام منصة تعليمية، يستطيع أن يسأل: هل تعزز هذه المنصة التفكير النقدي كما فعل سقراط؟ أم أنها تكرّس التلقي السلبي؟ هذا الوعي النقدي هو ما يميز المعلم المُدرِك عن الناقل الآلي."
    },
    {
        type: "essay",
        question: "كيف تُفسّر مقولة \"التاريخ زين الأديب وعمدة اللبيب\" في سياق إعداد المعلم؟",
        modelAnswer: "المعلم ليس ناقل معلومات فقط، بل مربي ومرشد ثقافي. المعرفة التاريخية تثري خلفيته الثقافية، وتوسّع آفاقه، وتجعله قادرًا على ربط الدروس بالسياقات الحضارية. كما أنها تمنحه الحكمة (\"عمدة اللبيب\") في التعامل مع المشكلات التربوية، لأنها تزوده بنماذج سابقة للحلول. في عصر المعلومات، يصبح هذا الإثراء ضروريًا لتمييز المعلم المبدع عن غيره."
    },
    {
        type: "essay",
        question: "ما العلاقة بين \"الهدف الوظيفي للتربية البدائية\" و\"أزمة الصلة بين التعليم والعمل\" اليوم؟",
        modelAnswer: "في المجتمعات البدائية، كان التعليم مرتبطًا مباشرة بالوظيفة (الصيد، الزراعة)، لذا كانت نتائجه واضحة ومباشرة. أما اليوم، فإن كثيرًا من المناهج منفصلة عن سوق العمل واحتياجات المجتمع، مما يولّد بطالة خريجين وفقدانًا لمعنى التعلم. الحل يكمن في إعادة تصميم التعليم ليكون أكثر وظيفية، مستلهمًا هذا المبدأ من التربية البدائية، خاصة عبر مشاريع تعلم قائمة على مشكلات واقعية باستخدام التكنولوجيا."
    },
    {
        type: "essay",
        question: "كيف يُمكن لدراسة \"تجربة مصر تحت محمد علي\" أن تُثري فهم سياسات التعليم الحالية؟",
        modelAnswer: "تجربة محمد علي تمثل محاولة تأسيس نظام تعليمي حديث مرتبط بأهداف الدولة (التحديث، بناء الجيش، تطوير الاقتصاد). دراسة هذه التجربة تكشف كيف رُبط التعليم بالتنمية الوطنية، وكيف وُظّف لخدمة أهداف سياسية. هذا يساعد في تحليل السياسات الحالية: هل التعليم اليوم يخدم رؤية تنموية وطنية؟ أم أنه منفصل عن احتياجات المجتمع؟ الفهم التاريخي يمنع التكرار الأعمى ويدفع نحو تخطيط استراتيجي واعٍ."
    },
    {
        type: "essay",
        question: "لماذا يُعدّ \"الارتباط العضوي بين المعلم والعمل\" درسًا جوهريًا في عصر التخصص؟",
        modelAnswer: "في المجتمعات البدائية، كان المعلم يُمارس ما يُعلّم، مما أعطى مصداقيته ووضّح نتائج تعلّم الطالب. أما اليوم، فقد يُدرّس معلم الاقتصاد دون أن يكون له خبرة في السوق، أو يُدرّس معلم تكنولوجيا دون ممارسة حقيقية. هذا الانفصال يولّد فجوة بين النظرية والتطبيق. لذا، يجب على معلمي تكنولوجيا التعليم أن يكونوا ممارسين فعليين للتكنولوجيا، لا مجرد ناقلين لمناهج جاهزة."
    },
    {
        type: "essay",
        question: "كيف يُسهم فهم \"التفكير الميتافيزيقي\" في تحليل المناهج الدينية المعاصرة؟",
        modelAnswer: "التفكير الميتافيزيقي في المجتمعات البدائية كان وسيلة لفهم العالم عبر الإيمان بقوى غيبية. اليوم، قد يظهر هذا التفكير في مناهج دينية تُقدّم المفاهيم كحقائق مطلقة دون تشجيع على التفكير النقدي. الفهم التاريخي يساعد المربين على التمييز بين نقل القيم (الذي هو جوهري) وبين إغلاق باب التفكير (الذي هو سلبي)، مما يسمح بتصميم مناهج دينية توازن بين الإيمان والعقل."
    },
    {
        type: "essay",
        question: "ما أهمية \"التجارب المقارنة\" (كأثينا وإسبرطة) في تطوير فلسفة تربوية وطنية؟",
        modelAnswer: "مقارنة تجربتي أثينا (التي ركّزت على الحرية والتفكير النقدي) وإسبرطة (التي ركّزت على الانضباط والولاء) تُظهر أن الفلسفة التربوية تعكس رؤية مجتمعية. هذا يدفعنا إلى التساؤل: ما الرؤية التي نريدها لمجتمعنا؟ هل نريد مواطنًا مبدعًا أم منضبطًا فقط؟ الدراسة المقارنة تمنع الانغلاق، وتفتح المجال لاختيار واعٍ يدمج الإيجابيات من التجارب المختلفة، بما يتناسب مع هويتنا واحتياجاتنا."
    },
    {
        type: "essay",
        question: "كيف يُفسّر النص ظاهرة \"طغيان النظرية على العملي\" في التعليم المعاصر؟",
        modelAnswer: "النص يشير إلى أن دراسة التاريخ تمكن من الحفر وراء جذور المشكلات. مشكلة \"طغيان النظرية على العملي\" تعود إلى فصل التعليم عن الحياة، وهو عكس ما كان سائدًا في المجتمعات البدائية. هذا الفصل يولّد خريجين غير قادرين على تطبيق معرفتهم. الفهم التاريخي يكشف أن هذه الظاهرة ليست طبيعية، بل نتاج تطورات مؤسسية وفلسفية، مما يفتح الباب لإصلاح جذري عبر إعادة التوازن بين النظرية والممارسة."
    },
    {
        type: "essay",
        question: "لماذا يُعدّ \"الاستعداد لدور المستقبل\" هدفًا جوهريًا لدراسة تاريخ التربية؟",
        modelAnswer: "الهدف ليس جعل الطالب \"مؤرخًا\"، بل مبادرًا في صنع المستقبل. عندما يرى الطالب كيف ساهم المربون السابقون في تشكيل عوالمهم، يُحفّز على أن يكون هو أيضًا مُساهمًا فعّالًا، لا مستهلكًا سلبيًا. في سياق تكنولوجيا التعليم، هذا يعني أن يسعى الطالب ليس فقط لاستخدام الأدوات، بل لابتكار حلول تربوية جديدة تُسهم في تطوير الحقل، مدركًا أنه يزرع \"شجرًا\" سيستفيد منه من يأتي بعده."
    }
];
        let currentQuestionIndex = 0;
        let userAnswers = [];
        let score = 0;
        let mcqCount = questions.filter(q => q.type === 'mcq').length;

        function saveProgress() {
            localStorage.setItem('quiz-history-a', JSON.stringify({
                currentQuestionIndex, userAnswers, score, mcqCount
            }));
        }

        function loadProgress() {
            const saved = localStorage.getItem('quiz-history-a');
            if (saved) {
                const p = JSON.parse(saved);
                currentQuestionIndex = p.currentQuestionIndex;
                userAnswers = p.userAnswers || [];
                score = p.score || 0;
                mcqCount = p.mcqCount || 0;
                document.getElementById('quizContainer').style.display = 'block';
                loadQuestion();
                return true;
            }
            return false;
        }

        document.addEventListener('DOMContentLoaded', () => {
            const root = document.documentElement;
            if (localStorage.getItem('theme') === 'day') {
                root.classList.add('day-mode');
                document.getElementById('themeToggle').innerHTML = '<i class="fas fa-sun"></i>';
            }
            document.getElementById('themeToggle').addEventListener('click', () => {
                if (root.classList.contains('day-mode')) {
                    root.classList.remove('day-mode');
                    localStorage.setItem('theme', 'night');
                    document.getElementById('themeToggle').innerHTML = '<i class="fas fa-moon"></i>';
                } else {
                    root.classList.add('day-mode');
                    localStorage.setItem('theme', 'day');
                    document.getElementById('themeToggle').innerHTML = '<i class="fas fa-sun"></i>';
                }
            });

            if (!loadProgress()) {
                document.getElementById('quizContainer').style.display = 'block';
                loadQuestion();
            }
        });

        function loadQuestion() {
            saveProgress();
            const q = questions[currentQuestionIndex];
            document.getElementById('questionCounter').textContent = `السؤال ${currentQuestionIndex + 1} من ${questions.length}`;
            document.getElementById('questionText').textContent = q.question;

            const container = document.getElementById('optionsContainer');
            container.innerHTML = '';
            document.getElementById('nextBtn').classList.add('d-none');
            document.getElementById('submitEssayBtn').classList.add('d-none');

            if (q.type === 'mcq') {
                q.options.forEach((opt, idx) => {
                    const btn = document.createElement('button');
                    btn.className = 'option-btn w-100 text-end';
                    btn.textContent = opt;
                    btn.onclick = () => selectMCQ(btn, idx);
                    container.appendChild(btn);
                });
                if (userAnswers[currentQuestionIndex] !== undefined) {
                    const btns = container.querySelectorAll('.option-btn');
                    const ans = userAnswers[currentQuestionIndex];
                    if (btns[ans]) {
                        btns[ans].classList.add('selected');
                        showMCQExplanation();
                        document.getElementById('nextBtn').classList.remove('d-none');
                    }
                }
            } else if (q.type === 'essay') {
                const ta = document.createElement('textarea');
                ta.className = 'essay-input';
                ta.placeholder = 'اكتب إجابتك هنا...';
                if (userAnswers[currentQuestionIndex]) {
                    ta.value = userAnswers[currentQuestionIndex];
                }
                container.appendChild(ta);
                document.getElementById('submitEssayBtn').classList.remove('d-none');
            }
        }

        function selectMCQ(btn, idx) {
            document.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected', 'correct', 'wrong'));
            btn.classList.add('selected');
            userAnswers[currentQuestionIndex] = idx;
            saveProgress();

            const q = questions[currentQuestionIndex];
            if (idx === q.correct) {
                btn.classList.add('correct');
                score++;
            } else {
                btn.classList.add('wrong');
                const correctBtn = container.querySelectorAll('.option-btn')[q.correct];
                if (correctBtn) correctBtn.classList.add('correct');
            }
            showMCQExplanation();
            document.getElementById('nextBtn').classList.remove('d-none');
        }

        function showMCQExplanation() {
            const q = questions[currentQuestionIndex];
            let exp = document.querySelector('.explanation-temp');
            if (!exp) {
                exp = document.createElement('div');
                exp.className = 'explanation explanation-temp';
                exp.innerHTML = `<h5>الشرح:</h5><p>${q.explanation}</p>`;
                document.getElementById('optionsContainer').appendChild(exp);
            }
        }

        function submitEssay() {
            const ta = document.querySelector('.essay-input');
            const ans = ta.value.trim();
            if (!ans) { alert('يرجى كتابة إجابة.'); return; }
            userAnswers[currentQuestionIndex] = ans;
            saveProgress();

            document.getElementById('submitEssayBtn').classList.add('d-none');

            const q = questions[currentQuestionIndex];
            const exp = document.createElement('div');
            exp.className = 'explanation';
            exp.innerHTML = `<h5>الإجابة النموذجية:</h5><p>${q.modelAnswer}</p>`;
            document.getElementById('optionsContainer').appendChild(exp);

            document.getElementById('nextBtn').classList.remove('d-none');
        }

        function nextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < questions.length) {
                loadQuestion();
            } else {
                document.getElementById('quizContainer').style.display = 'none';
                document.getElementById('finalFormContainer').style.display = 'block';
            }
        }

        function saveStudentData() {
            const name = document.getElementById('studentName').value.trim();
            const id = document.getElementById('studentId').value.trim();
            if (!name || !id) { alert('أدخل الاسم وال ID.'); return; }

            const data = {
                studentName: name,
                studentId: id,
                subjectName: "تاريخ التربيه",
                section: "أ",
                score: score,
                totalMCQ: mcqCount,
                percentage: mcqCount ? Math.round((score / mcqCount) * 100) : 0,
                timestamp: new Date().toISOString(),
                answers: userAnswers.map((a, i) => ({
                    question: questions[i].question,
                    type: questions[i].type,
                    userAnswer: a,
                    correctAnswer: questions[i].type === 'mcq' ? questions[i].options[questions[i].correct] : null,
                    explanation: questions[i].type === 'mcq' ? questions[i].explanation : questions[i].modelAnswer
                }))
            };

            if (window.saveToFirebase) window.saveToFirebase(data);

            localStorage.removeItem('quiz-history-a');
            showFinalResults(name, id, data.percentage);
        }

        function showFinalResults(name, id, pct) {
            document.getElementById('finalFormContainer').style.display = 'none';
            document.getElementById('resultContainer').style.display = 'block';

            document.getElementById('finalScore').textContent = `${score}/${mcqCount}`;
            let txt = "حاول مرة أخرى! 💪";
            if (pct >= 80) txt = "ممتاز! 🌟";
            else if (pct >= 60) txt = "جيد جدًا! 👍";
            else if (pct >= 40) txt = "لابأس! 📚";
            document.getElementById('resultText').textContent = txt;

            const expCont = document.getElementById('explanationsContainer');
            expCont.innerHTML = '<h3 class="text-light mb-4">جميع إجاباتك:</h3>';
            questions.forEach((q, i) => {
                const div = document.createElement('div');
                div.className = 'explanation';
                const userAns = userAnswers[i] || "لم تجب";
                if (q.type === 'mcq') {
                    div.innerHTML = `
                        <h5>السؤال ${i+1}: ${q.question}</h5>
                        <p><strong>إجابتك:</strong> ${q.options[userAns] || 'لم تجب'}</p>
                        <p><strong>الإجابة الصحيحة:</strong> ${q.options[q.correct]}</p>
                        <p><strong>الشرح:</strong> ${q.explanation}</p>
                    `;
                } else {
                    div.innerHTML = `
                        <h5>السؤال ${i+1} (مقالي): ${q.question}</h5>
                        <p><strong>إجابتك:</strong> ${userAns}</p>
                        <p><strong>الإجابة النموذجية:</strong> ${q.modelAnswer}</p>
                    `;
                }
                expCont.appendChild(div);
            });
        }

        function shareToWhatsApp() {
            const cc = document.getElementById('countryCode').value.trim();
            const phone = document.getElementById('phoneNumber').value.trim();
            if (!cc || !phone) { alert('أدخل رمز الدولة ورقم الهاتف.'); return; }
            const full = cc + phone.replace(/^0+/, '');
            const msg = `لقد انتهيت من اختبار "تاريخ التربيه - المجموعة أ" وحصلت على ${score}/${mcqCount}!`;
            window.open(`https://wa.me/${full}?text=${encodeURIComponent(msg)}`, '_blank');
        }

        function downloadPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            // Note: jsPDF has limited Arabic support by default. This might need a custom font.
            // For simplicity, we'll keep the structure.
            doc.setFont('Amiri'); // A common font that might support Arabic.
            doc.text('نتائج الاختبار', 105, 20, null, null, 'center');
            doc.text('تاريخ التربية - المجموعة أ', 20, 40);
            doc.text(`النتيجة: ${score}/${mcqCount}`, 20, 50);
            let y = 70;
            questions.forEach((q, i) => {
                if (y > 250) { doc.addPage(); y = 20; }
                doc.text(`السؤال ${i+1}: ${q.question}`, 20, y, { maxWidth: 170 });
                y += 10;
                const ans = userAnswers[i] || 'لم تجب';
                if (q.type === 'mcq') {
                    doc.text(`إجابتك: ${q.options[ans] || 'لم تجب'}`, 25, y, { maxWidth: 165 });
                    y += 10;
                    doc.text(`الصحيحة: ${q.options[q.correct]}`, 25, y, { maxWidth: 165 });
                } else {
                    doc.text(`إجابتك: ${ans}`, 25, y, { maxWidth: 165 });
                }
                y += 15;
            });
            doc.save('نتيجة_تاريخ التربيه_أ.pdf');
        }

        function restartQuiz() {
            localStorage.removeItem('quiz-history-a');
            currentQuestionIndex = 0; userAnswers = []; score = 0;
            document.getElementById('resultContainer').style.display = 'none';
            document.getElementById('quizContainer').style.display = 'block';
            loadQuestion();
        }

        function backToMaterials() {
            localStorage.removeItem('quiz-history-a');
            window.location.href = 'materials.html';
        }

        function exitQuiz() {
            if (confirm('هل تريد إنهاء الاختبار؟')) {
                localStorage.removeItem('quiz-history-a');
                window.location.href = 'materials.html';
            }
        }
    </script>
</body>
</html>
