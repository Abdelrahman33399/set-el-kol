<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>مواعيدي - ست الكل</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
    <style>
        .chat-bot {
            background: rgba(30, 30, 50, 0.8);
            border-radius: 20px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            border: 1px solid var(--border-color);
            backdrop-filter: blur(10px);
        }
        .bot-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 1rem;
        }
        .bot-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--accent-orange);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        .bot-bubble {
            background: rgba(255, 107, 53, 0.2);
            padding: 1rem;
            border-radius: 15px;
            margin: 0.5rem 0;
            color: white;
            border-right: 3px solid var(--accent-orange);
        }
        .user-input {
            display: flex;
            gap: 10px;
            margin-top: 1rem;
        }
        .user-input input {
            flex: 1;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--border-color);
            color: white;
            padding: 10px 15px;
            border-radius: 12px;
        }
        .action-btns {
            display: flex;
            gap: 10px;
            margin: 1.5rem 0;
            flex-wrap: wrap;
        }
        .action-btn {
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            transition: all 0.3s;
            border: none;
            cursor: pointer;
        }
        .add-btn { background: var(--accent-orange); color: white; }
        .add-btn:hover { background: #e05a2a; }
        .clear-btn { background: #6c757d; color: white; }
        .clear-btn:hover { background: #5a6268; }
        .edit-btn { background: #ffc107; color: black; }
        .edit-btn:hover { background: #e0a800; }
        .admin-section {
            background: rgba(50, 50, 80, 0.6);
            border-radius: 16px;
            padding: 1.5rem;
            margin-top: 3rem;
            border: 1px solid rgba(255, 107, 53, 0.3);
        }
        .admin-badge {
            background: var(--accent-orange);
            color: white;
            padding: 5px 10px;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
        }
          /* زر العودة للرئيسية - ثابت في الأسفل */
.back-to-home-btn {
    position: initial; /* لتثبيت العنصر في مكانه على الشاشة */
    bottom: 20px;    /* يبعد 20 بكسل من أسفل الصفحة */
    left: 20px;      /* يبعد 20 بكسل من يسار الصفحة */
    z-index: 1000;   /* لضمان ظهوره فوق باقي المحتوى */
    
    /* الخصائص الأخرى للتصميم */
    background: var(--accent-orange);
    color: white;
    border: none;
    padding: 12px 20px;
    border-radius: 30px;
    text-decoration: none;
    font-weight: 600;
    box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
    transition: all 0.3s ease;
}

.back-to-home-btn:hover {
    background: #e05a2a;
    box-shadow: 0 8px 20px rgba(255, 107, 53, 0.5);
    transform: scale(1.05); /* تأثير بسيط للتكبير */
}
    </style>
</head>
<body>
    <div class="container py-5">
        <h1 class="neon-title text-center mb-4"> مواعيدي الأسبوعية</h1>

        <!-- البوت الذكي -->
        <div class="row justify-content-center">
            <div class="col-12 col-md-10 col-lg-8">
                <div class="chat-bot">
                    <div class="bot-header">
                        <div class="bot-avatar">🤖</div>
                        <h5>بوت ست الكل الذكي</h5>
                    </div>
                    <div class="bot-bubble">
                        👋 مرحبا! أنا هنا عشان أساعدك تنظم مواعيدك الأسبوعية. قول لي: "أضف موعد" أو "اعرض الجدول" أو "امسح كل حاجة".
                    </div>
                    <div id="chatMessages">
                        <!-- الرسائل تظهر هنا -->
                    </div>
                    <div class="user-input">
                        <input type="text" id="userCommand" placeholder="اكتب أمرك هنا..." class="form-control">
                        <button class="btn add-btn" onclick="processCommand()">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- أزرار التحكم -->
        <div class="row justify-content-center mt-4">
            <div class="col-12 col-md-10 col-lg-8">
                <div class="action-btns">
                    <button class="action-btn add-btn" onclick="showAddForm()">
                        <i class="fas fa-plus-circle me-1"></i> إضافة موعد يدوي
                    </button>
                    <button class="action-btn clear-btn" onclick="clearAllAppointments()">
                        <i class="fas fa-trash-alt me-1"></i> مسح كل الجدول
                    </button>
                    <a href="index.html" class="back-to-home-btn">
    <i class="fas fa-arrow-left me-2"></i> العودة للرئيسية
</a>

                </div>
            </div>
        </div>

        <!-- نموذج إضافة موعد (مخفي في البداية) -->
        <div class="row justify-content-center mt-4" id="addFormContainer" style="display:none;">
            <div class="col-12 col-md-10 col-lg-8">
                <div class="card bg-dark text-light p-4">
                    <h4><i class="fas fa-calendar-plus me-2"></i> أضف موعد جديد</h4>
                    <form id="addAppointment">
                        <div class="mb-3">
                            <input type="text" class="form-control bg-secondary text-light" id="appointmentTitle" placeholder="عنوان الموعد" required>
                        </div>
                        <div class="mb-3">
                            <input type="datetime-local" class="form-control bg-secondary text-light" id="appointmentTime" required>
                        </div>
                        <button type="submit" class="btn w-100 add-btn">
                            <i class="fas fa-save me-2"></i> حفظ الموعد
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <!-- جدول المواعيد -->
        <div class="row justify-content-center mt-4">
            <div class="col-12 col-md-10 col-lg-8">
                <h3 class="text-light mb-3">📋 جدول مواعيدك</h3>
                <div class="table-responsive">
                    <table class="table table-dark table-hover">
                        <thead>
                            <tr>
                                <th><i class="fas fa-check-circle"></i></th>
                                <th>الوقت</th>
                                <th>العنوان</th>
                                <th>الإجراءات</th>
                            </tr>
                        </thead>
                        <tbody id="appointmentsTable">
                            <!-- سيتم ملؤه ديناميكيًا -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- قسم مواعيد الأدمن -->
        <div class="row justify-content-center mt-5">
            <div class="col-12 col-md-10 col-lg-8">
                <div class="admin-section">
                    <div class="d-flex align-items-center gap-2 mb-3">
                        <span class="admin-badge">من الأدمن</span>
                        <h4 class="mb-0 text-light">📌 مواعيد إجبارية</h4>
                    </div>
                    <div class="table-responsive">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>الوقت</th>
                                    <th>العنوان</th>
                                    <th>النوع</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>2025-04-07T10:00</td>
                                    <td>تسليم المشروع النهائي</td>
                                    <td><span class="badge bg-danger">مثال</span></td>
                                </tr>
                                <tr>
                                    <td>2025-04-10T14:00</td>
                                    <td>امتحان منتصف الفصل</td>
                                    <td><span class="badge bg-danger">مثال</span></td>
                                </tr>
                                <tr>
                                    <td>2025-04-14T09:00</td>
                                    <td>جلسة مراجعة عامة</td>
                                    <td><span class="badge bg-warning text-dark">مثال</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let appointments = JSON.parse(localStorage.getItem('appointments')) || [];

        // تحميل الجدول عند فتح الصفحة
        document.addEventListener('DOMContentLoaded', function() {
            renderAppointments();
        });

        // معالجة أوامر البوت
        function processCommand() {
            const command = document.getElementById('userCommand').value.trim().toLowerCase();
            const messagesDiv = document.getElementById('chatMessages');
            
            if (!command) return;

            // إضافة رسالة المستخدم
            messagesDiv.innerHTML += `
                <div class="text-end mb-2">
                    <span class="badge bg-secondary">أنت: ${command}</span>
                </div>
            `;

            // معالجة الأوامر
            if (command.includes('أضف') || command.includes('اضف') || command.includes('add')) {
                showAddForm();
                messagesDiv.innerHTML += `
                    <div class="bot-bubble">
                        ✅ حاضر! هفتح لك نموذج لإضافة موعد جديد. املأ البيانات واضغط حفظ.
                    </div>
                `;
            } 
            else if (command.includes('اعرض') || command.includes('show') || command.includes('جدول')) {
                messagesDiv.innerHTML += `
                    <div class="bot-bubble">
                        📅 هذا هو جدول مواعيدك الحالي. لو عايز تضيف أو تعدله، قول لي!
                    </div>
                `;
            } 
            else if (command.includes('امسح') || command.includes('clear') || command.includes('مسح')) {
                clearAllAppointments();
                messagesDiv.innerHTML += `
                    <div class="bot-bubble">
                        🗑️ تم مسح كل مواعيدك! تقدر تبدأ من جديد.
                    </div>
                `;
            } 
            else if (command.includes('تعديل') || command.includes('عدّل') || command.includes('edit')) {
                editAnyAppointment();
                messagesDiv.innerHTML += `
                    <div class="bot-bubble">
                        ✏️ حاضر! اختار الموعد اللي عايز تعدله من الجدول واضغط على زر التعديل جنبه.
                    </div>
                `;
            } 
            else {
                messagesDiv.innerHTML += `
                    <div class="bot-bubble">
                        🤔 عذراً، ما فهمتش قصدك. جرب تقول: "أضف موعد"، "اعرض الجدول"، "امسح كل حاجة"، أو "عدل موعد".
                    </div>
                `;
            }

            // تنظيف حقل الإدخال
            document.getElementById('userCommand').value = '';
            
            // التمرير للأسفل
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }

        // إظهار نموذج الإضافة
        function showAddForm() {
            document.getElementById('addFormContainer').style.display = 'block';
            document.getElementById('addAppointment').addEventListener('submit', function(e) {
                e.preventDefault();
                const title = document.getElementById('appointmentTitle').value;
                const time = document.getElementById('appointmentTime').value;

                if (!title || !time) {
                    showNotification('يرجى إدخال العنوان والوقت!');
                    return;
                }

                const newAppointment = {
                    id: Date.now(),
                    title: title,
                    time: time,
                    completed: false
                };

                appointments.push(newAppointment);
                saveAppointments();
                renderAppointments();
                showNotification(`تم إضافة موعد: ${title}`);

                // إخفاء النموذج
                this.reset();
                document.getElementById('addFormContainer').style.display = 'none';
            });
        }

        // عرض المواعيد في الجدول
        function renderAppointments() {
            const tableBody = document.getElementById('appointmentsTable');
            tableBody.innerHTML = '';

            if (appointments.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="4" class="text-center text-muted">لا توجد مواعيد بعد. استخدم البوت أو الزر لإضافة موعد جديد!</td>
                    </tr>
                `;
                return;
            }

            // ترتيب المواعيد حسب الوقت
            appointments.sort((a, b) => new Date(a.time) - new Date(b.time));

            appointments.forEach(app => {
                const row = document.createElement('tr');
                const timeFormatted = new Date(app.time).toLocaleString('ar-EG', {
                    weekday: 'short',
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit'
                });

                row.innerHTML = `
                    <td>
                        <input type="checkbox" class="form-check-input" ${app.completed ? 'checked' : ''} 
                               onchange="toggleCompleted(${app.id}, this.checked)">
                    </td>
                    <td>${timeFormatted}</td>
                    <td>${app.title} ${app.completed ? '<span class="badge bg-success ms-2">تم ✔</span>' : ''}</td>
                    <td>
                        <button class="btn btn-sm btn-warning me-1" onclick="editAppointment(${app.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="deleteAppointment(${app.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }

        // تبديل حالة الإنجاز
        function toggleCompleted(id, isCompleted) {
            const app = appointments.find(a => a.id === id);
            if (app) {
                app.completed = isCompleted;
                saveAppointments();
                renderAppointments();
                showNotification(isCompleted ? 'تم إكمال المهمة! 🎉' : 'تم إعادة فتح المهمة.');
            }
        }

        // تعديل موعد
        function editAppointment(id) {
            const app = appointments.find(a => a.id === id);
            if (!app) return;

            const newTitle = prompt('عدل عنوان الموعد:', app.title);
            if (newTitle === null) return;

            const newTime = prompt('عدل وقت الموعد (YYYY-MM-DDTHH:MM):', app.time);
            if (newTime === null) return;

            app.title = newTitle;
            app.time = newTime;
            saveAppointments();
            renderAppointments();
            showNotification('تم تعديل الموعد بنجاح! ✏️');
        }

        // تعديل أي موعد (من البوت)
        function editAnyAppointment() {
            if (appointments.length === 0) {
                showNotification('ما فيش مواعيد عشان تعدلها!');
                return;
            }
            const ids = appointments.map(a => a.id).join(', ');
            const idToEdit = prompt(`اختر ID الموعد اللي عايز تعدله:\n(${ids})`);
            if (!idToEdit) return;
            editAppointment(parseInt(idToEdit));
        }

        // حذف موعد
        function deleteAppointment(id) {
            if (confirm('هل أنت متأكد أنك تريد حذف هذا الموعد؟')) {
                appointments = appointments.filter(a => a.id !== id);
                saveAppointments();
                renderAppointments();
                showNotification('تم حذف الموعد! 🗑️');
            }
        }

        // مسح كل المواعيد
        function clearAllAppointments() {
            if (confirm('هل أنت متأكد أنك تريد مسح كل المواعيد؟')) {
                appointments = [];
                saveAppointments();
                renderAppointments();
                showNotification('تم مسح كل المواعيد! 🧹');
            }
        }

        // حفظ المواعيد في localStorage
        function saveAppointments() {
            localStorage.setItem('appointments', JSON.stringify(appointments));
        }

        // إشعار مؤقت
        function showNotification(msg) {
            const div = document.createElement('div');
            div.className = 'alert alert-info position-fixed bottom-0 end-0 m-3';
            div.style.zIndex = 9999;
            div.innerHTML = `<i class="fas fa-bell me-2"></i>${msg}`;
            document.body.appendChild(div);
            setTimeout(() => div.remove(), 4000);
        }
    </script>
</body>
</html>