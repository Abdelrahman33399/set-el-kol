<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>لوحة التحكم - ست الكل</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
    <style>
        body {
            background-color: var(--bg-color);
            overflow-x: hidden;
            position: relative;
        }
        #particles-js {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: -1;
        }
        .user-banner {
            background: rgba(30, 30, 50, 0.85);
            backdrop-filter: blur(15px);
            border-radius: 24px;
            padding: 3rem 2rem;
            margin: 2rem auto;
            max-width: 500px;
            text-align: center;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4);
            border: 1px solid var(--border-color);
            animation: slideIn 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .platform-name {
            font-size: 2.2rem;
            font-weight: 800;
            background: var(--primary-neon);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 2rem;
            text-shadow: 0 0 15px rgba(199, 125, 255, 0.5);
        }
        .avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            /* ✅ مهم: object-fit: cover يسبب مشاكل مع GIF — غيره لـ fill أو امسحه */
            object-fit: fill; /* أو امسح السطر ده خالص */
            border: 4px solid var(--accent-orange);
            box-shadow: 0 0 25px rgba(255, 107, 53, 0.5);
            margin-bottom: 1.5rem;
            /* ✅ مهم: منع التلاشي أو التوقف */
            animation: none !important;
            will-change: unset !important;
        }
        .user-info {
            background: rgba(255, 255, 255, 0.05);
            padding: 1.5rem;
            border-radius: 16px;
            margin: 1.5rem 0;
            border: 1px solid rgba(255, 107, 53, 0.3);
        }
        .info-row {
            display: flex;
            justify-content: space-between;
            margin: 0.8rem 0;
            padding: 0.5rem;
            border-radius: 10px;
            background: rgba(255, 107, 53, 0.1);
        }
        .info-label {
            font-weight: 600;
            color: #ddd;
        }
        .info-value {
            color: white;
            font-weight: 500;
        }
        .action-btns {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 2rem;
            flex-wrap: wrap;
        }
        .btn-action {
            padding: 12px 28px;
            border-radius: 30px;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s ease;
            display: inline-block;
            text-align: center;
        }
        .home-btn {
            background: #6c757d;
            color: white;
        }
        .home-btn:hover {
            background: #5a6268;
            transform: translateY(-3px);
        }
        .logout-btn {
            background: #dc3545;
            color: white;
        }
        .logout-btn:hover {
            background: #c82333;
            transform: translateY(-3px);
        }
        @media (max-width: 576px) {
            .user-banner {
                margin: 1rem;
                padding: 2rem 1.5rem;
            }
            .platform-name {
                font-size: 1.8rem;
            }
            .avatar {
                width: 80px;
                height: 80px;
            }
            .action-btns {
                flex-direction: column;
                gap: 0.8rem;
            }
            .btn-action {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div id="particles-js"></div>

    <div class="container d-flex align-items-center justify-content-center min-vh-100">
        <div class="user-banner">
            <h1 class="platform-name">ست الكل</h1>
            <!-- ✅ الصورة المتحركة — لن يتم استبدالها -->
            <img src="personal-branding.gif" alt="صورة المستخدم" class="avatar" id="userAvatar">
            <div class="user-info">
                <div class="info-row">
                    <span class="info-label">👤 الاسم:</span>
                    <span class="info-value" id="userName">[الاسم]</span>
                </div>
                <div class="info-row">
                    <span class="info-label">📧 البريد:</span>
                    <span class="info-value" id="userEmail">[example@email.com]</span>
                </div>
                <div class="info-row">
                    <span class="info-label">📱 الهاتف:</span>
                    <span class="info-value" id="userPhone">[010XXXXXXXX]</span>
                </div>
                <div class="info-row">
                    <span class="info-label">🆔 المعرف:</span>
                    <span class="info-value" id="userId">[ID]</span>
                </div>
            </div>
            <div class="action-btns">
                <a href="index.html" class="btn-action home-btn">
                    <i class="fas fa-home me-1"></i> الصفحة الرئيسية
                </a>
                <a href="#" class="btn-action logout-btn" id="logoutBtn">
                    <i class="fas fa-sign-out-alt me-1"></i> تسجيل خروج
                </a>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
    <script src="js/particles-config.js"></script>

    <!-- Firebase Modular SDK -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
        import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDeapYypO595vcDWUoh1gOncsGkQ5EZdyE",
            authDomain: "sit-el-kol.firebaseapp.com",
            projectId: "sit-el-kol",
            storageBucket: "sit-el-kol.firebasestorage.app",
            messagingSenderId: "573924344198",
            appId: "1:573924344198:web:fec2e9a54c1c152cd16c07",
            measurementId: "G-CWVJDKPS0M"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // تحميل بيانات المستخدم عند فتح الصفحة
        onAuthStateChanged(auth, (user) => {
            if (user) {
                const uid = user.uid;
                const userDocRef = doc(db, "users", uid);

                getDoc(userDocRef)
                    .then((docSnap) => {
                        if (docSnap.exists()) {
                            const userData = docSnap.data();
                            document.getElementById('userName').textContent = userData.name;
                            document.getElementById('userEmail').textContent = userData.email;
                            document.getElementById('userPhone').textContent = userData.phone || "غير محدد";
                            document.getElementById('userId').textContent = userData.id;

                            // ✅ مسحنا السطر اللي بيغير مصدر الصورة — عشان الـ GIF يفضل ظاهر
                            // document.getElementById('userAvatar').src = avatarUrl; ← مش هنشغله!
                        }
                    })
                    .catch((error) => {
                        console.error("Error getting user document:", error);
                    });
            } else {
                window.location.href = 'index.html';
            }
        });

        // تسجيل الخروج
        document.getElementById('logoutBtn').addEventListener('click', function(e) {
            e.preventDefault();
            signOut(auth)
                .then(() => {
                    showNotification('تم تسجيل الخروج بنجاح! 👋', 'info');
                    setTimeout(() => {
                        window.location.href = 'index.html';
                    }, 1500);
                })
                .catch((error) => {
                    console.error("Error signing out:", error);
                });
        });

        // إشعار مؤقت
        function showNotification(msg, type) {
            const div = document.createElement('div');
            div.className = `alert alert-${type} position-fixed bottom-0 end-0 m-3`;
            div.style.zIndex = 9999;
            div.innerHTML = `<i class="fas fa-bell me-2"></i>${msg}`;
            document.body.appendChild(div);
            setTimeout(() => div.remove(), 3000);
        }
    </script>
</body>
</html>